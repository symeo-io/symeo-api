Description: Symeo Api - Dynamo DB Table
Parameters:
  SymeoApiTableName:
    Type: String
    Default: symeo-api
  DynamoScalingRoleArn:
    Type: String
  Env:
    Type: String
    Default: dev

Resources:
  SymeoApiConfigurationsTable:
    Type: "AWS::DynamoDB::Table"
    Properties:
      TableName: !Sub ${SymeoApiTableName}-configurations-${Env}
      BillingMode: PAY_PER_REQUEST
      PointInTimeRecoverySpecification:
        PointInTimeRecoveryEnabled: true
      AttributeDefinitions:
      -
        AttributeName: hashKey
        AttributeType: S
      -
        AttributeName: rangeKey
        AttributeType: S
      KeySchema:
      -
        AttributeName: hashKey
        KeyType: HASH
      -
        AttributeName: rangeKey
        KeyType: RANGE
      Tags:
      - Key: Project
        Value: SymeoApi
      - Key: Env
        Value: !Ref Env
  SymeoApiApiKeysTable:
    Type: "AWS::DynamoDB::Table"
    Properties:
      TableName: !Sub ${SymeoApiTableName}-api-keys-${Env}
      BillingMode: PAY_PER_REQUEST
      PointInTimeRecoverySpecification:
        PointInTimeRecoveryEnabled: true
      AttributeDefinitions:
      -
        AttributeName: hashKey
        AttributeType: S
      -
        AttributeName: rangeKey
        AttributeType: S
      KeySchema:
      -
        AttributeName: hashKey
        KeyType: HASH
      -
        AttributeName: rangeKey
        KeyType: RANGE
      Tags:
      - Key: Project
        Value: SymeoApi
      - Key: Env
        Value: !Ref Env

Outputs:
  SymeoApiConfigurationsTable:
    Value: !Ref SymeoApiConfigurationsTable
  SymeoApiApiKeysTable:
    Value: !Ref SymeoApiApiKeysTable
